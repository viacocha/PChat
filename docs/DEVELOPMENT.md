# PChat å¼€å‘æŒ‡å—

## é¡¹ç›®ç»“æ„

```
PChat/
â”œâ”€â”€ bin/                 # ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶
â”œâ”€â”€ cmd/                 # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ pchat/           # P2PèŠå¤©å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ main.go      # å®¢æˆ·ç«¯ä¸»ç¨‹åºï¼ˆåŒ…å«æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼‰
â”‚   â”‚   â”œâ”€â”€ ui.go        # UIç•Œé¢å®ç°
â”‚   â”‚   â”œâ”€â”€ dht_discovery.go  # DHTå‘ç°åŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ registry.go  # æ³¨å†ŒæœåŠ¡å™¨å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ message_processor.go  # æ¶ˆæ¯å¤„ç†
â”‚   â”‚   â”œâ”€â”€ file_transfer_helpers.go  # æ–‡ä»¶ä¼ è¾“è¾…åŠ©å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ file_utils.go  # æ–‡ä»¶å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ network_helpers.go  # ç½‘ç»œè¾…åŠ©å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ cli_format.go  # CLIæ ¼å¼åŒ–å‡½æ•°
â”‚   â”‚   â””â”€â”€ *_test.go    # å„ç§æµ‹è¯•æ–‡ä»¶
â”‚   â””â”€â”€ registry/        # æ³¨å†ŒæœåŠ¡å™¨
â”‚       â”œâ”€â”€ main.go      # æ³¨å†ŒæœåŠ¡å™¨ä¸»ç¨‹åº
â”‚       â”œâ”€â”€ ui.go        # æ³¨å†ŒæœåŠ¡å™¨UI
â”‚       â””â”€â”€ main_test.go # æ³¨å†ŒæœåŠ¡å™¨æµ‹è¯•
â”œâ”€â”€ internal/            # å†…éƒ¨åŒ…
â”‚   â”œâ”€â”€ crypto/          # åŠ å¯†è§£å¯†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ crypto.go    # åŠ å¯†å®ç°
â”‚   â”‚   â””â”€â”€ crypto_test.go # åŠ å¯†æµ‹è¯•
â”‚   â”œâ”€â”€ discovery/       # DHTç”¨æˆ·å‘ç°æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ dht.go       # DHTå‘ç°å®ç°
â”‚   â”‚   â””â”€â”€ dht_logic_test.go # DHTé€»è¾‘æµ‹è¯•
â”‚   â””â”€â”€ registry/        # æ³¨å†ŒæœåŠ¡å™¨å®¢æˆ·ç«¯åº“
â”‚       â”œâ”€â”€ client.go    # æ³¨å†Œå®¢æˆ·ç«¯å®ç°
â”‚       â””â”€â”€ client_test.go # æ³¨å†Œå®¢æˆ·ç«¯æµ‹è¯•
â”œâ”€â”€ docs/                # æ–‡æ¡£
â”‚   â”œâ”€â”€ USAGE.md         # ä½¿ç”¨è¯´æ˜
â”‚   â”œâ”€â”€ TEST_DHT.md      # DHTæµ‹è¯•æŒ‡å—
â”‚   â”œâ”€â”€ DHT_TEST_SUMMARY.md # DHTæµ‹è¯•æ€»ç»“
â”‚   â””â”€â”€ DEVELOPMENT.md   # å¼€å‘æŒ‡å—
â”œâ”€â”€ tests/               # æµ‹è¯•æ–‡ä»¶
â”‚   â””â”€â”€ test_dht.sh      # DHTæµ‹è¯•è„šæœ¬
â”œâ”€â”€ scripts/             # è„šæœ¬æ–‡ä»¶
â”‚   â””â”€â”€ run_mock_tests.sh # Mockæµ‹è¯•è„šæœ¬
â”œâ”€â”€ received_files/      # æ¥æ”¶çš„æ–‡ä»¶
â”œâ”€â”€ go.mod              # Goæ¨¡å—æ–‡ä»¶
â”œâ”€â”€ go.sum              # Goä¾èµ–æ ¡éªŒå’Œ
â”œâ”€â”€ Makefile            # æ„å»ºè„šæœ¬
â”œâ”€â”€ README.md           # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ LICENSE             # è®¸å¯è¯æ–‡ä»¶
â”œâ”€â”€ SECURITY_HARDENING.md # å®‰å…¨åŠ å›ºæ–‡æ¡£
â”œâ”€â”€ TEST_COVERAGE_REPORT.md # æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
â””â”€â”€ CLEANUP_SUMMARY.md  # æ¸…ç†æ€»ç»“
```

## å¼€å‘ç¯å¢ƒè®¾ç½®

### ç³»ç»Ÿè¦æ±‚

- Go 1.25.3 æˆ–æ›´é«˜ç‰ˆæœ¬
- Git ç‰ˆæœ¬æ§åˆ¶å·¥å…·
- æ”¯æŒçš„æ“ä½œç³»ç»Ÿï¼ˆLinux, macOS, Windowsï¼‰

### è·å–æºç 

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/viacocha/PChat.git
cd PChat

# å®‰è£…ä¾èµ–
make install
# æˆ–è€…
go mod download
```

## æ„å»ºé¡¹ç›®

### ä½¿ç”¨Makefileæ„å»º

```bash
# æ„å»ºæ‰€æœ‰äºŒè¿›åˆ¶æ–‡ä»¶
make build

# æ„å»ºç‰¹å®šäºŒè¿›åˆ¶æ–‡ä»¶
make bin/pchat
make bin/registryd

# æ¸…ç†æ„å»ºäº§ç‰©
make clean
```

### æ‰‹åŠ¨æ„å»º

```bash
# æ„å»ºå®¢æˆ·ç«¯
go build -o bin/pchat ./cmd/pchat

# æ„å»ºæ³¨å†ŒæœåŠ¡å™¨
go build -o bin/registryd ./cmd/registry
```

## è¿è¡Œé¡¹ç›®

### è¿è¡Œæ³¨å†ŒæœåŠ¡å™¨

```bash
# ä½¿ç”¨Makefile
make run-registry

# æˆ–ç›´æ¥è¿è¡Œ
./bin/registryd
```

### è¿è¡Œå®¢æˆ·ç«¯

```bash
# ä½¿ç”¨Makefileè¿è¡Œç¤ºä¾‹
make run-alice
make run-bob

# æˆ–ç›´æ¥è¿è¡Œ
./bin/pchat -port 9001 -username Alice
./bin/pchat -port 9002 -username Bob
```

## æµ‹è¯•

### è¿è¡Œå•å…ƒæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
make test
# æˆ–
go test ./...

# è¿è¡Œç‰¹å®šåŒ…çš„æµ‹è¯•
go test ./internal/crypto/...
```

### è¿è¡Œé›†æˆæµ‹è¯•

```bash
# è¿è¡ŒDHTæµ‹è¯•
make test-dht
# æˆ–
./tests/test_dht.sh
```

### ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š

```bash
# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
make cover
# æˆ–
go test -coverprofile=coverage.txt ./...
go tool cover -html=coverage.txt -o coverage.html
```

## ä»£ç è´¨é‡

### ä»£ç æ ¼å¼åŒ–

```bash
# æ ¼å¼åŒ–ä»£ç 
make fmt
# æˆ–
go fmt ./...
```

### ä»£ç æ£€æŸ¥

```bash
# é™æ€åˆ†æ
make vet
# æˆ–
go vet ./...

# ä»£ç é£æ ¼æ£€æŸ¥
make lint
# æˆ–
golint ./...
```

## ä¾èµ–ç®¡ç†

### æ·»åŠ æ–°ä¾èµ–

```bash
# æ·»åŠ ä¾èµ–
go get github.com/some/package

# æ¸…ç†æœªä½¿ç”¨çš„ä¾èµ–
go mod tidy
```

### éªŒè¯ä¾èµ–

```bash
# éªŒè¯ä¾èµ–å®Œæ•´æ€§
make verify
# æˆ–
go mod verify
```

## å¼€å‘æµç¨‹

### 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯

```bash
# åˆ›å»ºæ–°åŠŸèƒ½åˆ†æ”¯
git checkout -b feature/new-feature

# æˆ–ä¿®å¤bugåˆ†æ”¯
git checkout -b bugfix/issue-description
```

### 2. ç¼–å†™ä»£ç 

- éµå¾ªGoè¯­è¨€ç¼–ç è§„èŒƒ
- æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£
- ç¼–å†™å•å…ƒæµ‹è¯•

### 3. æµ‹è¯•ä»£ç 

```bash
# è¿è¡Œæµ‹è¯•
make test

# æ£€æŸ¥ä»£ç è´¨é‡
make fmt
make vet
```

### 4. æäº¤æ›´æ”¹

```bash
# æ·»åŠ æ›´æ”¹
git add .

# æäº¤æ›´æ”¹
git commit -m "Add new feature: description of changes"

# æ¨é€åˆ°è¿œç¨‹ä»“åº“
git push origin feature/new-feature
```

### 5. åˆ›å»ºPull Request

åœ¨GitHubä¸Šåˆ›å»ºPull Requestï¼Œç­‰å¾…ä»£ç å®¡æŸ¥ã€‚

## æ¨¡å—è¯´æ˜

### cmd/pchat/main.go

ä¸»ç¨‹åºå…¥å£ï¼ŒåŒ…å«æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼š
- **åŠ å¯†è§£å¯†**ï¼šAESå¯¹ç§°åŠ å¯†ã€RSAéå¯¹ç§°åŠ å¯†ã€æ•°å­—ç­¾åã€é˜²é‡æ”¾æ”»å‡»
- **æ¶ˆæ¯å¤„ç†**ï¼šæ¶ˆæ¯åŠ å¯†ã€ç­¾åã€éªŒè¯ã€è§£å¯†
- **æ–‡ä»¶ä¼ è¾“**ï¼šæ–‡ä»¶åˆ†å—ä¼ è¾“ã€å®Œæ•´æ€§æ ¡éªŒã€è¿›åº¦æ˜¾ç¤º
- **è¿æ¥ç®¡ç†**ï¼šP2Pè¿æ¥å»ºç«‹ã€å…¬é’¥äº¤æ¢ã€è¿æ¥ç»´æŠ¤
- **å‘½ä»¤å¤„ç†**ï¼šCLIå‘½ä»¤è§£æå’Œæ‰§è¡Œ
- **ä¼˜é›…å…³é—­**ï¼šèµ„æºæ¸…ç†ã€è¿æ¥å…³é—­ã€ç¦»çº¿é€šçŸ¥

### cmd/pchat/ui.go

UIç•Œé¢å®ç°ï¼ˆå¯é€‰ï¼‰ï¼š
- **ç•Œé¢å¸ƒå±€**ï¼šæ¶ˆæ¯æ˜¾ç¤ºåŒºã€ç”¨æˆ·åˆ—è¡¨ã€çŠ¶æ€æ ã€è¾“å…¥æ¡†
- **å®æ—¶æ›´æ–°**ï¼šç”¨æˆ·åˆ—è¡¨åˆ·æ–°ã€æ¶ˆæ¯æ˜¾ç¤ºã€çŠ¶æ€æ›´æ–°
- **å‘½ä»¤å¤„ç†**ï¼šUIæ¨¡å¼ä¸‹çš„å‘½ä»¤è§£æå’Œæ‰§è¡Œ
- **äº¤äº’åŠŸèƒ½**ï¼šé”®ç›˜å¿«æ·é”®ã€å‘½ä»¤è¾“å…¥ã€æ¶ˆæ¯å‘é€

### cmd/pchat/dht_discovery.go

DHTå»ä¸­å¿ƒåŒ–å‘ç°åŠŸèƒ½ï¼š
- **DHTç½‘ç»œ**ï¼šKademlia DHTç®—æ³•å®ç°
- **ç”¨æˆ·æ³¨å†Œ**ï¼šå°†è‡ªå·±çš„ä¿¡æ¯å­˜å‚¨åˆ°DHT
- **ç”¨æˆ·å‘ç°**ï¼šé€šè¿‡DHTæŸ¥æ‰¾å…¶ä»–ç”¨æˆ·
- **è‡ªåŠ¨æ›´æ–°**ï¼šå®šæœŸå¹¿æ’­å’Œæ›´æ–°ç”¨æˆ·ä¿¡æ¯
- **æœ¬åœ°ç¼“å­˜**ï¼šç¼“å­˜å‘ç°çš„ç”¨æˆ·ä¿¡æ¯

### cmd/pchat/registry.go

æ³¨å†ŒæœåŠ¡å™¨ç›¸å…³åŠŸèƒ½ï¼š
- **æ³¨å†ŒæœåŠ¡å™¨**ï¼šå¯é€‰çš„æ³¨å†ŒæœåŠ¡å™¨å®ç°
- **æ³¨å†Œå®¢æˆ·ç«¯**ï¼šå®¢æˆ·ç«¯æ³¨å†Œã€å¿ƒè·³ã€æŸ¥è¯¢åŠŸèƒ½
- **ç”¨æˆ·ç®¡ç†**ï¼šç”¨æˆ·æ³¨å†Œã€æ³¨é”€ã€åˆ—è¡¨æŸ¥è¯¢

### internal/crypto

åŠ å¯†è§£å¯†æ¨¡å—ï¼š
- **å¯†é’¥ç”Ÿæˆ**ï¼šRSAå¯†é’¥å¯¹ç”Ÿæˆ
- **æ¶ˆæ¯åŠ å¯†**ï¼šAES+RSAæ··åˆåŠ å¯†
- **æ•°å­—ç­¾å**ï¼šæ¶ˆæ¯ç­¾åå’ŒéªŒè¯
- **é˜²é‡æ”¾æ”»å‡»**ï¼šnonceç®¡ç†å’ŒéªŒè¯

### internal/discovery

DHTç”¨æˆ·å‘ç°æ¨¡å—ï¼š
- **DHTå®ç°**ï¼šåŸºäºlibp2p-kad-dhtçš„DHTç½‘ç»œ
- **ç”¨æˆ·å­˜å‚¨**ï¼šç”¨æˆ·ä¿¡æ¯åœ¨DHTä¸­çš„å­˜å‚¨å’ŒæŸ¥è¯¢
- **æ•°æ®éªŒè¯**ï¼šç”¨æˆ·ä¿¡æ¯çš„éªŒè¯å’Œé€‰æ‹©

### internal/registry

æ³¨å†ŒæœåŠ¡å™¨å®¢æˆ·ç«¯åº“ï¼š
- **å®¢æˆ·ç«¯å®ç°**ï¼šæ³¨å†Œã€å¿ƒè·³ã€æŸ¥è¯¢ç­‰åŠŸèƒ½çš„åº•å±‚å®ç°
- **åè®®å¤„ç†**ï¼šä¸æ³¨å†ŒæœåŠ¡å™¨çš„é€šä¿¡åè®®

## APIæ–‡æ¡£

### åŠ å¯†æ¨¡å—API

```go
// GenerateKeys ç”ŸæˆRSAå¯†é’¥å¯¹
func GenerateKeys() (*rsa.PrivateKey, rsa.PublicKey, error)

// EncryptAndSignMessage åŠ å¯†æ¶ˆæ¯å¹¶ç­¾å
func EncryptAndSignMessage(msg string, senderPrivKey *rsa.PrivateKey, recipientPubKey *rsa.PublicKey) (string, error)

// DecryptAndVerifyMessage è§£å¯†æ¶ˆæ¯å¹¶éªŒè¯ç­¾å
func DecryptAndVerifyMessage(encryptedMsg string, recipientPrivKey *rsa.PrivateKey, senderID rsa.PublicKey) (string, bool, error)
```

### DHTå‘ç°æ¨¡å—API

```go
// NewDHTDiscovery åˆ›å»ºDHTå‘ç°æœåŠ¡
func NewDHTDiscovery(ctx context.Context, h host.Host, username string) (*DHTDiscovery, error)

// AnnounceSelf å¹¿æ’­è‡ªå·±çš„ä¿¡æ¯åˆ°DHT
func (dd *DHTDiscovery) AnnounceSelf(ctx context.Context)

// LookupUser æŸ¥æ‰¾ç”¨æˆ·
func (dd *DHTDiscovery) LookupUser(ctx context.Context, username string) (*UserInfo, error)

// ListUsers åˆ—å‡ºæ‰€æœ‰å·²çŸ¥ç”¨æˆ·
func (dd *DHTDiscovery) ListUsers() []*UserInfo

// GetUserByPeerID æ ¹æ®èŠ‚ç‚¹IDè·å–ç”¨æˆ·ä¿¡æ¯
func (dd *DHTDiscovery) GetUserByPeerID(peerID string) *UserInfo

// RecordUserFromConnection ä»è¿æ¥è®°å½•ç”¨æˆ·ä¿¡æ¯
func (dd *DHTDiscovery) RecordUserFromConnection(username, peerID string, addresses []string)

// DiscoverUsers å‘ç°ç½‘ç»œä¸­çš„ç”¨æˆ·
func (dd *DHTDiscovery) DiscoverUsers(ctx context.Context) error

// Close å…³é—­DHTå‘ç°æœåŠ¡
func (dd *DHTDiscovery) Close() error
```

### æ³¨å†Œå®¢æˆ·ç«¯API

```go
// NewRegistryClient åˆ›å»ºæ³¨å†Œå®¢æˆ·ç«¯
func NewRegistryClient(serverAddr string, h host.Host, username string) *RegistryClient

// Register æ³¨å†Œåˆ°æœåŠ¡å™¨
func (rc *RegistryClient) Register() error

// Unregister ä»æœåŠ¡å™¨æ³¨é”€
func (rc *RegistryClient) Unregister() error

// SendHeartbeat å‘é€å¿ƒè·³ä¿æŒè¿æ¥
func (rc *RegistryClient) SendHeartbeat() error

// ListClients åˆ—å‡ºæ‰€æœ‰å®¢æˆ·ç«¯
func (rc *RegistryClient) ListClients() ([]*ClientInfo, error)

// LookupClient æŸ¥æ‰¾å®¢æˆ·ç«¯
func (rc *RegistryClient) LookupClient(targetID string) (*ClientInfo, error)

// StartHeartbeat å¯åŠ¨å¿ƒè·³goroutine
func (rc *RegistryClient) StartHeartbeat(ctx context.Context)
```

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯ç±»å‹

1. **ç½‘ç»œè¿æ¥é”™è¯¯**
   - æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
   - éªŒè¯èŠ‚ç‚¹IDæ˜¯å¦æ­£ç¡®
   - ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸

2. **åŠ å¯†é”™è¯¯**
   - æ£€æŸ¥å¯†é’¥ç”Ÿæˆæ˜¯å¦æˆåŠŸ
   - éªŒè¯å…¬é’¥äº¤æ¢æ˜¯å¦å®Œæˆ
   - ç¡®è®¤åŠ å¯†ç®—æ³•æ”¯æŒ

3. **DHTé”™è¯¯**
   - ç­‰å¾…DHTç½‘ç»œç¨³å®š
   - æ£€æŸ¥èŠ‚ç‚¹è¿æ¥çŠ¶æ€
   - éªŒè¯DHTè·¯ç”±è¡¨

### é”™è¯¯å¤„ç†æœ€ä½³å®è·µ

- ä½¿ç”¨é”™è¯¯åŒ…è£…æä¾›ä¸Šä¸‹æ–‡ä¿¡æ¯
- è®°å½•è¯¦ç»†çš„é”™è¯¯æ—¥å¿—
- æä¾›ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
- å®ç°ä¼˜é›…çš„é”™è¯¯æ¢å¤æœºåˆ¶

## æ€§èƒ½ä¼˜åŒ–

### å†…å­˜ä¼˜åŒ–

- å¤ç”¨ç¼“å†²åŒºå‡å°‘å†…å­˜åˆ†é…
- åŠæ—¶é‡Šæ”¾ä¸éœ€è¦çš„èµ„æº
- ä½¿ç”¨å¯¹è±¡æ± ç®¡ç†é¢‘ç¹åˆ›å»ºçš„å¯¹è±¡

### ç½‘ç»œä¼˜åŒ–

- ä½¿ç”¨è¿æ¥æ± å‡å°‘è¿æ¥å»ºç«‹å¼€é”€
- å®ç°æ¶ˆæ¯æ‰¹å¤„ç†å‡å°‘ç½‘ç»œå¾€è¿”
- ä¼˜åŒ–æ•°æ®åºåˆ—åŒ–æ ¼å¼

### å¹¶å‘ä¼˜åŒ–

- ä½¿ç”¨goroutineå¤„ç†å¹¶å‘ä»»åŠ¡
- ä½¿ç”¨channelè¿›è¡Œgoroutineé—´é€šä¿¡
- é¿å…ç«æ€æ¡ä»¶ä½¿ç”¨äº’æ–¥é”

## å®‰å…¨è€ƒè™‘

### åŠ å¯†å®‰å…¨

- ä½¿ç”¨å¼ºåŠ å¯†ç®—æ³•ï¼ˆAES-256, RSA-2048ï¼‰
- å®šæœŸæ›´æ–°å¯†é’¥
- é˜²æ­¢å¯†é’¥æ³„éœ²

### ç½‘ç»œå®‰å…¨

- éªŒè¯æ¶ˆæ¯æ¥æº
- é˜²æ­¢é‡æ”¾æ”»å‡»
- æ£€æŸ¥æ¶ˆæ¯å®Œæ•´æ€§

### åº”ç”¨å®‰å…¨

- è¾“å…¥éªŒè¯å’Œè¿‡æ»¤
- é˜²æ­¢æ³¨å…¥æ”»å‡»
- å®‰å…¨çš„é”™è¯¯å¤„ç†

## è°ƒè¯•æŠ€å·§

### æ—¥å¿—è°ƒè¯•

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
export PCHAT_DEBUG=1
./bin/pchat -port 9001 -username Alice
```

### æ€§èƒ½åˆ†æ

```bash
# CPUæ€§èƒ½åˆ†æ
go tool pprof cpu.prof

# å†…å­˜æ€§èƒ½åˆ†æ
go tool pprof mem.prof
```

### ç½‘ç»œè°ƒè¯•

```bash
# æŸ¥çœ‹ç½‘ç»œè¿æ¥
netstat -an | grep 900

# æŠ“åŒ…åˆ†æ
tcpdump -i lo0 port 9001
```

## è´¡çŒ®æŒ‡å—

### ä»£ç è§„èŒƒ

1. éµå¾ªGoè¯­è¨€ç¼–ç è§„èŒƒ
2. æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£
3. ç¼–å†™å•å…ƒæµ‹è¯•
4. ä¿æŒä»£ç ç®€æ´å’Œå¯è¯»æ€§

### æäº¤è§„èŒƒ

1. ä½¿ç”¨æœ‰æ„ä¹‰çš„æäº¤ä¿¡æ¯
2. æ¯ä¸ªæäº¤åªåŒ…å«ä¸€ä¸ªåŠŸèƒ½æˆ–ä¿®å¤
3. åœ¨æäº¤å‰è¿è¡Œæµ‹è¯•
4. éµå¾ªé¡¹ç›®çš„ä»£ç é£æ ¼

### Pull Requestæµç¨‹

1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
2. å®ç°åŠŸèƒ½å¹¶æ·»åŠ æµ‹è¯•
3. è¿è¡Œæ‰€æœ‰æµ‹è¯•ç¡®ä¿é€šè¿‡
4. æäº¤Pull Requestå¹¶æè¿°æ›´æ”¹
5. æ ¹æ®å®¡æŸ¥æ„è§è¿›è¡Œä¿®æ”¹

## å‘å¸ƒæµç¨‹

### ç‰ˆæœ¬ç®¡ç†

ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ï¼š
- ä¸»ç‰ˆæœ¬å·ï¼šä¸å…¼å®¹çš„APIä¿®æ”¹
- æ¬¡ç‰ˆæœ¬å·ï¼šå‘åå…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
- ä¿®è®¢å·ï¼šå‘åå…¼å®¹çš„é—®é¢˜ä¿®æ­£

### å‘å¸ƒæ­¥éª¤

1. æ›´æ–°ç‰ˆæœ¬å·
2. æ›´æ–°CHANGELOG
3. åˆ›å»ºGitæ ‡ç­¾
4. æ„å»ºå‘å¸ƒç‰ˆæœ¬
5. å‘å¸ƒåˆ°GitHub Releases

## å¸¸è§é—®é¢˜

### æ„å»ºé—®é¢˜

**é—®é¢˜ï¼šä¾èµ–ä¸‹è½½å¤±è´¥**
```bash
# è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ä»£ç†æˆ–æ›´æ¢æº
go env -w GOPROXY=https://goproxy.cn,direct
```

**é—®é¢˜ï¼šç¼–è¯‘é”™è¯¯**
```bash
# è§£å†³æ–¹æ¡ˆï¼šæ¸…ç†å¹¶é‡æ–°æ„å»º
make clean
make build
```

### è¿è¡Œé—®é¢˜

**é—®é¢˜ï¼šç«¯å£è¢«å ç”¨**
```bash
# è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ä¸åŒç«¯å£
./bin/pchat -port 9003 -username Charlie
```

**é—®é¢˜ï¼šè¿æ¥å¤±è´¥**
```bash
# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥èŠ‚ç‚¹IDå’Œç½‘ç»œè¿æ¥
# ç¡®ä¿é˜²ç«å¢™å…è®¸è¿æ¥
```

### æµ‹è¯•é—®é¢˜

**é—®é¢˜ï¼šæµ‹è¯•è¶…æ—¶**
```bash
# è§£å†³æ–¹æ¡ˆï¼šå¢åŠ è¶…æ—¶æ—¶é—´
go test -timeout 30s ./...
```

**é—®é¢˜ï¼šè¦†ç›–ç‡ä½**
```bash
# è§£å†³æ–¹æ¡ˆï¼šç¼–å†™æ›´å¤šæµ‹è¯•ç”¨ä¾‹
# ç‰¹åˆ«æ˜¯è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯å¤„ç†
```

## æœªæ¥æ”¹è¿›

### åŠŸèƒ½å¢å¼º

1. **å¤šåª’ä½“æ”¯æŒ**ï¼šæ”¯æŒå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ä¼ è¾“
2. **ç¾¤èŠåŠŸèƒ½**ï¼šæ”¯æŒå¤šäººç¾¤èŠ
3. **æ¶ˆæ¯å†å²**ï¼šæœ¬åœ°æ¶ˆæ¯å­˜å‚¨å’ŒæŸ¥è¯¢
4. **è”ç³»äººç®¡ç†**ï¼šå¥½å‹åˆ—è¡¨å’Œé»‘åå•

### æ€§èƒ½ä¼˜åŒ–

1. **è¿æ¥ä¼˜åŒ–**ï¼šæ”¹è¿›NATç©¿é€å’Œè¿æ¥ç¨³å®šæ€§
2. **å­˜å‚¨ä¼˜åŒ–**ï¼šä¼˜åŒ–DHTå­˜å‚¨å’ŒæŸ¥è¯¢æ€§èƒ½
3. **ä¼ è¾“ä¼˜åŒ–**ï¼šå®ç°æ›´é«˜æ•ˆçš„æ•°æ®ä¼ è¾“åè®®

### å®‰å…¨å¢å¼º

1. **ç«¯åˆ°ç«¯åŠ å¯†**ï¼šæ›´å¼ºçš„åŠ å¯†ç®—æ³•å’Œå¯†é’¥ç®¡ç†
2. **èº«ä»½éªŒè¯**ï¼šç”¨æˆ·èº«ä»½éªŒè¯å’Œæˆæƒæœºåˆ¶
3. **éšç§ä¿æŠ¤**ï¼šæ›´å¥½çš„éšç§ä¿æŠ¤å’ŒåŒ¿åæ€§

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- ğŸŒ ä¸ªäººç½‘ç«™: [https://tanghg.cpolar.cn](https://tanghg.cpolar.cn)
- ğŸ“§ é‚®ç®±: [tanghg.cn@gmail.com](mailto:tanghg.cn@gmail.com)
- ğŸ“ æäº¤GitHub Issue: [https://github.com/viacocha/PChat/issues](https://github.com/viacocha/PChat/issues)